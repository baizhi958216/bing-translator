# Bing翻译器

一个简单高效的 VSCode 扩展，使用必应翻译 API 进行文本翻译。

## 功能特性

- **快速翻译**：通过键盘快捷键、右键菜单或状态栏按钮翻译文本
- **动态语言选择**：翻译时即时选择源语言和目标语言
- **两种界面模式**：
  - **Webview 模式**（默认）：现代化统一界面，所有选项集中在一个面板
  - **QuickPick 模式**：多步骤界面，通过独立对话框选择语言
- **两种翻译模式**：
  - **输入框模式** (Ctrl+Shift+T)：在对话框中输入文本并查看翻译结果
  - **选中模式** (Ctrl+Alt+T 或右键)：翻译编辑器中选中的文本，并可选择替换原文
- **右键菜单集成**：选中文本后右键即可翻译
- **可配置语言**：设置您偏好的默认源语言和目标语言
- **状态栏集成**：点击地球图标进行翻译，工具提示动态显示当前语言对
- **自动检测**：支持自动检测源语言
- **智能错误处理**：为常见问题提供用户友好的错误消息
- **多语言界面**：支持中英文界面

## 使用方法

### Webview 模式（默认）

使用 Webview 模式时，您将获得一个现代化的翻译面板，所有选项集中在一个界面：

1. 按 `Ctrl+Shift+T` 或点击状态栏按钮打开翻译面板
2. 从下拉框选择源语言（或使用自动检测）
3. 从下拉框选择目标语言
4. 使用交换按钮（⇄）快速切换源语言和目标语言
5. 输入或粘贴要翻译的文本
6. 点击"翻译"按钮或按 `Ctrl+Enter`
7. 查看翻译结果
8. 使用"复制结果"按钮复制翻译
9. 使用"替换选中文本"按钮替换编辑器中的选中文本（翻译选中内容时）

### QuickPick 模式

要使用经典的多步骤界面：

1. 打开设置（文件 > 首选项 > 设置）
2. 搜索 "Bing Translator"
3. 取消勾选 "Use Webview UI"
4. 现在翻译时，您将逐步选择语言

### 方法 1：输入框翻译 (Ctrl+Shift+T)
1. 按 `Ctrl+Shift+T` (Windows/Linux) 或 `Cmd+Shift+T` (Mac)
2. 选择源语言和目标语言（或使用默认值）
3. 输入要翻译的文本
4. 按 Enter 查看翻译结果
5. 复制翻译结果或按 Esc 关闭

### 方法 2：选中文本翻译 (Ctrl+Alt+T)
1. 在编辑器中选中文本
2. 按 `Ctrl+Alt+T` (Windows/Linux) 或 `Cmd+Alt+T` (Mac)
3. 选择源语言和目标语言（或使用默认值）
4. 查看翻译结果
5. 按 Enter 用翻译替换选中内容，或按 Esc 保持原文

### 方法 3：右键菜单翻译
1. 在编辑器中选中文本
2. 右键点击选中的文本
3. 点击"翻译选中内容"
4. 选择源语言和目标语言（或使用默认值）
5. 查看翻译结果
6. 按 Enter 用翻译替换选中内容，或按 Esc 保持原文

### 方法 4：状态栏按钮
1. 点击状态栏（右下角）的 "$(globe) 翻译" 按钮
2. 选择源语言和目标语言（或使用默认值）
3. 输入要翻译的文本
4. 按 Enter 查看翻译结果

## 配置

您可以在 VSCode 设置中配置扩展：

1. 打开设置（文件 > 首选项 > 设置）
2. 搜索 "Bing Translator"
3. 可用设置：
   - **源语言**：默认源语言（默认：`en`）
   - **目标语言**：默认目标语言（默认：`zh-Hans`）
   - **使用 Webview 界面**：使用统一的 Webview 界面（默认：`true`）
     - 启用时：现代化面板，所有选项在一个界面
     - 禁用时：多步骤 QuickPick 界面

### 支持的语言代码

常用语言代码：
- `en` - 英语
- `zh-Hans` - 简体中文
- `zh-Hant` - 繁体中文
- `ja` - 日语
- `ko` - 韩语
- `fr` - 法语
- `de` - 德语
- `es` - 西班牙语
- `ru` - 俄语
- `ar` - 阿拉伯语
- `pt` - 葡萄牙语
- `it` - 意大利语
- `auto-detect` - 自动检测源语言

完整的 180+ 种支持语言列表，请查看 [src/languages.json](src/languages.json)。

### 配置示例

在的 `settings.json` 添加：

```json
{
  "bing-translator.sourceLanguage": "en",
  "bing-translator.targetLanguage": "zh-Hans"
}
```

## 命令

- **翻译文本** (`bing-translator.translate`)：打开输入框翻译文本
- **翻译选中内容** (`bing-translator.translateSelection`)：翻译编辑器中选中的文本

## 键盘快捷键

- `Ctrl+Shift+T` (Mac: `Cmd+Shift+T`)：打开翻译输入框
- `Ctrl+Alt+T` (Mac: `Cmd+Alt+T`)：翻译选中的文本（当有文本被选中时）

## 安装

### 从源码安装

1. 克隆或下载此仓库
2. 在 VSCode 中打开文件夹
3. 按 F5 在新的扩展开发主机窗口中运行扩展
4. 测试翻译功能

### 打包并安装

1. 安装 vsce：`npm install -g @vscode/vsce`
2. 打包扩展：`npm run package`
3. 安装 .vsix 文件：扩展 > 从 VSIX 安装

## 系统要求

- VSCode 版本 1.96.0 或更高
- 互联网连接（用于必应翻译 API）

## 已知限制

- 需要活动的互联网连接
- 受必应翻译速率限制约束
- 如果使用过于频繁可能需要验证码验证
- 最大文本长度：约 1000 个字符（必应翻译限制）

## 故障排除

### "翻译次数超限"
这意味着您已达到必应翻译的速率限制。等待几分钟后重试。

### "无法连接到翻译服务"
检查您的互联网连接和防火墙设置。确保您可以访问 bing.com。

### "翻译服务需要验证"
必应翻译要求进行验证码验证。等待一段时间后再试。

### 状态栏未显示
扩展在启动时激活。如果状态栏未出现，请尝试重新加载 VSCode。

## 更新日志

查看 [CHANGELOG.zh-CN.md](CHANGELOG.zh-CN.md) 了解详细的版本历史。
